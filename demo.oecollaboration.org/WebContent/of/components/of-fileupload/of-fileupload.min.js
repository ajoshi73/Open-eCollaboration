+ function($) {

    'use strict';

    $(document).ready(function() {

        var x = 0;

        $('.of-fileupload').each(function() {
            $(this).ofFileupload();
        });

    });

    $.fn.ofFileupload = function() {

        var body = $('body'),
            el = $(this),
            elId = $(this).data('id');

        body.on('dragover', function(e) {

            if (body.hasClass('of-fileover'))
                return false;

            var types = e.originalEvent.dataTransfer.types;

            for (var i = 0, il = types.length; i < il; i++) {
                var type = types[i];

                types[i] = type.toLowerCase();
            }

            if ($.inArray(types, 'files') < 0) {

                body.addClass('of-fileover');

            }

        }).on('dragleave', function() {

            if (!body.hasClass('of-fileover'))
                return false;

            body.removeClass('of-fileover');

        }).on('dragover', '.of-fileupload', function() {

            if (el.hasClass('of-fileover') || el.hasClass('of-file-uploaded'))
                return false;

            el.addClass('of-fileover');

        }).on('dragleave', '.of-fileupload', function(e) {
            e.stopPropagation();

            if (!el.hasClass('of-fileover'))
                return false;

            el.removeClass('of-fileover');

        }).on('drop', '.of-fileupload', function(e) {

            if (el.hasClass('of-file-uploaded'))
                return false;

            e.preventDefault();
            el.ofAddProgress({
                value: 10,
                callback: function() {
                    el.addClass('of-file-uploaded').removeClass('of-fileover');
                    body.removeClass('of-fileover');
                }
            });

        });

        el.find('input').on('change', function(e) {

            if (el.hasClass('of-file-uploaded'))
                return false;

            e.preventDefault();

            el.ofAddProgress({
                value: 10,
                callback: function() {
                    el.addClass('of-file-uploaded').removeClass('of-fileover');
                    body.removeClass('of-fileover');
                }
            });

        });

        $(document).on('click', '.of-uploaded a', function(e) {
            e.preventDefault();

            el.removeClass('of-file-uploaded');
        });

    }

}(jQuery);